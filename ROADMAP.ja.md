# DecisionGraph Core – ロードマップ（日本語）

このドキュメントは **DecisionGraph Core** の開発ロードマップを示します。
目的は機能追加ではなく、**決定論的な判断カーネルとしての長期的な構造安定性**です。

---

## Phase 0 — 概念・思想の確立（完了）

**ステータス:** ✅ 完了

### 内容
- コア思想の確立
  - 決定論的であること
  - 状態を再生（Replay）可能であること
  - AIによる推論を行わない
  - 確率・ヒューリスティックを用いない
- 明確な責務分離
  - Core ≠ Schema ≠ IO ≠ CLI
- 「Kernel は判断しない。検証し、再生するのみ」という原則

### 成果物
- README.md（Non-goals / パッケージ境界）
- Constitution / 哲学ドキュメント（概念層）

---

## Phase 1 — 構造基盤の確立（完了）

**ステータス:** ✅ 完了

このフェーズでは、プロジェクトを**構造的に信用できる状態**にすることを目的としました。

### 達成事項
- モノレポ構造の安定化
- TypeScript Project References の完全導入
- dev用型チェックと build用 emit の明確な分離
- `src/` 配下に生成物を置かない構成の確立
- ルート `tsconfig.json` による全体グラフ検証
- CI で `tsc -b` を実行し、構造破壊を防止
- 開発環境の一致を確認
  - macOS / Windows
  - Node.js 20.x
  - pnpm 9.x

### このフェーズで保証されたこと
- 再現可能なビルド
- 決定論的な型依存グラフ
- 暗黙的・偶発的なパッケージ依存の排除
- ローカルと CI の挙動一致

このフェーズは、プロジェクトの
**「荷重を支える骨格（load-bearing skeleton）」** を確立しました。

---

## Phase 2 — Core の成熟と不変条件（次フェーズ）

**ステータス:** 🟡 計画中 / 部分的に着手済み

目的は、**表面積を増やさずに意味的正しさを強化すること**です。

### 目標
- Core が前提とする **不変条件（Invariants）** の明文化
- カーネルレベルの検証強化（必要最小限）
- 内部整合性保証の明確化

### すでに達成されている事項（前倒し）
- 不変条件の文章化（Constitution v0.2）
- Core / Schema / API 間の規範的整合性確立
- 「実装より仕様が上位」という憲法秩序の確定
- Commit immutability / append-only の仕様固定

### 想定作業
- 以下に関する不変条件の整理
  - Graph 構造
  - Node / Edge の同一性
  - 時間的整合性
- エラー型・分類の整理
- lint / diff / replay の契約明確化
- 不変条件に対する最小限・高密度なテスト追加

### 明確な非目標
- パフォーマンス最適化は行わない
- 新しいストレージ実装は追加しない
- 保証を弱める便利 API は導入しない

---

## Phase 3 — Policy と拡張境界の確立（将来）

**ステータス:** ⚪ 計画中

目的は、**将来的な複雑性崩壊を未然に防ぐこと**です。

### 目標
- policy ロジックが core を侵食しない構造を保つ
- 拡張ポイントを明示的かつ安全に定義する

### 想定作業
- policy の分離検討
  - `@decisiongraph/policies` など
- 以下の形式化
  - Policy インターフェース
  - Policy 互換性ルール
- 以下間のバージョン関係整理
  - Core
  - Schema
  - IO Adapter

このフェーズは、**長期保守性の防波堤**です。

---

## Phase 4 — エコシステム・周辺ツール（将来 / 任意）

**ステータス:** ⚪ 任意・下流フェーズ

目的は、**Core の外側での使いやすさ向上**です。

### 想定方向
- CLI の使い勝手改善（抽象を漏らさない範囲で）
- 可視化・検査ツール
- 上位レイヤー（TraceOS / ClaimAtom 等）との統合例

※ すべて **Core の外側** に厳密に配置される必要があります。

---

## 恒久的な非目標（Always）

DecisionGraph Core では、以下を一貫して行いません。

- AI による推論
- 確率的・経験則的挙動
- ワークフローエンジン
- 権限・認可システム
- 組織依存ロジック
- UI・UX

これらを必要とする機能は、必ず上位レイヤーに属します。

---

## 指導原則

> **DecisionGraph Core はインフラである。**
> 退屈であることは美徳であり、
> 予測可能性は必須条件である。
>
> すべての機能追加は、
> 決定論性への影響を正当化できなければならない。

---

- English roadmap: [ROADMAP.md](./ROADMAP.md)
- 日本語ロードマップ: [ROADMAP.ja.md](./ROADMAP.ja.md)
